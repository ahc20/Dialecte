<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dialect ‚Äì Accueil</title>
  <link rel="stylesheet" href="styles/style.css" />
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="icon" type="image/png" href="images/logo.png" />
  <style>
    .dialect-dropdown {
      margin: 2.5em auto 1.5em auto;
      max-width: 350px;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 2px 12px #0001;
      padding: 2em 1.5em 1.5em 1.5em;
      text-align: center;
    }

    .dialect-dropdown label {
      font-size: 1.1rem;
      color: var(--text-light);
      margin-bottom: 0.7em;
      display: block;
    }

    .dialect-list {
      list-style: none;
      padding: 0;
      margin: 0.5em 0 0 0;
    }

    .dialect-list li {
      font-size: 1.15rem;
      font-weight: 600;
      padding: 0.7em 0.5em;
      border-radius: 10px;
      margin-bottom: 0.3em;
      transition: background 0.18s, color 0.18s, filter 0.18s;
      cursor: pointer;
      background: #f5f3e7;
      color: #7B61FF;
      box-shadow: 0 1px 4px #7B61FF11;
    }

    .dialect-list li:not(.active) {
      filter: blur(2.2px) grayscale(0.7) brightness(1.1);
      color: #bdbdbd;
      cursor: not-allowed;
      background: #f5f3e7;
      position: relative;
    }

    .dialect-list li:not(.active)::after {
      content: 'Bient√¥t';
      position: absolute;
      right: 1.2em;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.95em;
      color: #bfa100;
      opacity: 0.7;
    }

    .dialect-list li.active {
      background: linear-gradient(90deg, #b7c7a3 0%, #e6ebdf 100%);
      color: #2d3a1f;
      filter: none;
      cursor: pointer;
      box-shadow: 0 2px 8px #9EB79633;
      border: 2px solid #7B61FF22;
    }

    .dialect-list li.active:hover {
      background: #e6ebdf;
      color: #7B61FF;
      border-color: #7B61FF;
    }
  </style>
</head>

<body>
  <button class="mobile-menu-btn">Menu</button>
  <div class="mobile-menu-bg"></div>
  <nav class="mobile-menu">
    <a href="index.html">üè† Accueil</a>
    <a href="review.html">üß† Apprendre</a>
    <a href="progres.html">üìà Progr√®s</a>
    <a href="login.html">üîê Connexion</a>
  </nav>
  <nav>
    <div class="logo"><img src="images/logo.png" alt="Dialect logo" style="height:48px;vertical-align:middle;"
        onerror="this.style.display='none';this.parentNode.textContent='Dialect.';"></div>
    <div class="nav-links">
      <a href="index.html" class="active">Accueil</a>
    </div>
    <div class="nav-actions">
      <a href="login.html" class="btn btn-purple">Se connecter</a>
      <a href="signup.html" class="btn btn-yellow">S'inscrire</a>
    </div>
  </nav>

  <main>
    <section class="main-card" style="max-width:700px;">
      <h1>Reconnecte-toi √† ta culture avec <span style="color:#7B61FF;">Dialect.</span></h1>
      <p class="subtitle" style="font-size:1.25rem; margin-bottom:1.5em;">D√©couvre, apprends et partage les richesses de
        ta langue d'origine.</p>
      <p style="color:var(--text-light); font-size:1.13rem; margin-bottom:2.2em;">
        <b>Dialect</b> est une application qui te permet de te reconnecter √† ta culture √† travers l'apprentissage de ton
        dialecte. <br>

        Notre mission&nbsp;: rendre chaque langue accessible, vivante et fi√®rement partag√©e.
      </p>
      <div class="dialect-dropdown">
        <label for="dialect-select">Choisis ton dialecte&nbsp;:</label>
        <ul class="dialect-list">
          <li class="active" onclick="window.location.href='kabyle.html'">Kabyle</li>
          <li>Peul</li>
          <li>Wolof</li>
          <li>Darija</li>
          <li>Chaoui</li>
          <li>Tamazight</li>
          <li>Tachelhit</li>
          <li>Chleuh</li>
        </ul>
      </div>
      <p style="color:#bfa100; font-size:1.05rem; margin-top:1.5em;">D'autres dialectes arrivent tr√®s bient√¥t&nbsp;!</p>
    </section>

    <!-- Section Vocabulaire Simple -->
    <section class="main-card" style="max-width:900px; margin-top:2em;">
      <h2 style="color:#7B61FF; margin-bottom:1.5em;">üìö Vocabulaire Kabyle</h2>
      <p style="color:var(--text-light); font-size:1.1rem; margin-bottom:1.5em;">
        Liste de nos 320 mots fran√ßais-kabyle.
      </p>

      <div id="vocabulaire-content"
        style="min-height:200px; padding:1em; background:#f8f9fa; border-radius:12px; border:2px dashed #7B61FF33;">
        <div style="text-align:center; color:var(--text-light);">
          <div style="font-size:2em; margin-bottom:0.5em;">‚è≥</div>
          <div>Chargement du vocabulaire...</div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    ¬© 2025 Dialect
  </footer>

  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="ui.js" type="module"></script>

  <!-- Script pour le menu mobile -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      console.log('=== D√âBOGAGE MENU MOBILE ===');

      const menuBtn = document.querySelector('.mobile-menu-btn');
      const mobileMenu = document.querySelector('.mobile-menu');
      const mobileMenuBg = document.querySelector('.mobile-menu-bg');

      console.log('√âl√©ments trouv√©s:', {
        menuBtn: menuBtn,
        mobileMenu: mobileMenu,
        mobileMenuBg: mobileMenuBg
      });

      if (!menuBtn) {
        console.error('‚ùå Bouton menu non trouv√© !');
        return;
      }
      if (!mobileMenu) {
        console.error('‚ùå Menu mobile non trouv√© !');
        return;
      }
      if (!mobileMenuBg) {
        console.error('‚ùå Fond menu non trouv√© !');
        return;
      }

      console.log('‚úÖ Tous les √©l√©ments trouv√©s');

      // Ouvrir le menu
      menuBtn.addEventListener('click', function (e) {
        console.log('üñ±Ô∏è Clic sur bouton menu d√©tect√©');
        e.preventDefault();
        e.stopPropagation();

        console.log('üìã Classes avant:', {
          menu: mobileMenu.className,
          bg: mobileMenuBg.className
        });

        mobileMenu.classList.add('open');
        mobileMenuBg.classList.add('open');

        console.log('üìã Classes apr√®s:', {
          menu: mobileMenu.className,
          bg: mobileMenuBg.className
        });

        console.log('‚úÖ Menu ouvert');
      });

      // Fermer le menu en cliquant sur le fond
      mobileMenuBg.addEventListener('click', function () {
        console.log('üñ±Ô∏è Clic sur fond d√©tect√©');
        mobileMenu.classList.remove('open');
        mobileMenuBg.classList.remove('open');
        console.log('‚úÖ Menu ferm√©');
      });

      // Fermer le menu en cliquant sur un lien
      const menuLinks = mobileMenu.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', function () {
          console.log('üñ±Ô∏è Clic sur lien menu d√©tect√©');
          mobileMenu.classList.remove('open');
          mobileMenuBg.classList.remove('open');
        });
      });

      console.log('‚úÖ Script menu mobile initialis√©');
    });
  </script>

  <script type="module">
    console.log('üöÄ Script principal charg√© !');
    import { auth, logout, initAuthListener } from "./firebase.js";
    import { renderNavAuthButtons } from "./ui.js";

    initAuthListener(user => {
      renderNavAuthButtons(user);
    });

    // Initialiser le gestionnaire de cartes et mettre √† jour le compteur (optionnel)
    async function updateDueCount() {
      try {
        await cardManager.loadCards();
        const stats = cardManager.getStats();
        const dueCountElement = document.getElementById('due-count');
        if (dueCountElement) {
          dueCountElement.textContent = stats.due;
        }
      } catch (error) {
        console.log('‚ÑπÔ∏è Compteur de cartes non disponible sur cette page');
      }
    }

    // Mettre √† jour le compteur au chargement (si possible)
    updateDueCount();

    console.log('üìö Script vocabulaire charg√© !');

    // Fonction simple pour afficher le vocabulaire
    function afficherVocabulaire(data) {
      console.log('üéØ afficherVocabulaire appel√©e avec:', data);

      let html = '<div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:1em;">';

      data.forEach((row, index) => {
        const fr = row['mot francais']?.trim();
        const kab = row['traduction kabyle']?.trim();

        console.log(`üìù Ligne ${index}: fr="${fr}", kab="${kab}"`);

        if (fr && kab) {
          html += `
            <div style="background:#fff; padding:1em; border-radius:12px; border:1px solid #7B61FF33; box-shadow:0 2px 8px rgba(123,97,255,0.1);">
              <div style="font-weight:600; color:#333; margin-bottom:0.5em;">${fr}</div>
              <div style="color:#7B61FF; font-size:0.95em;">${kab}</div>
            </div>
          `;
        }
      });

      html += '</div>';

      const container = document.getElementById('vocabulaire-content');
      if (container) {
        container.innerHTML = html;
        console.log('‚úÖ Vocabulaire affich√© !');
      } else {
        console.error('‚ùå Container vocabulaire non trouv√© !');
      }
    }
    console.log('üîÑ D√©but du chargement CSV...');
    Papa.parse('/data/320_mots_a_la_main.csv', {
      download: true,
      header: true,
      skipEmptyLines: true,
      delimiter: ';',
      complete: ({ data }) => {
        console.log('üìä Donn√©es CSV charg√©es:', data);
        console.log('üìä Nombre de lignes:', data.length);
        console.log('üìä Premi√®re ligne:', data[0]);
        console.log('üìä Colonnes disponibles:', Object.keys(data[0] || {}));
        afficherVocabulaire(data);
      },
      error: (error) => {
        console.error('‚ùå Erreur de chargement CSV:', error);
        console.error('‚ùå D√©tails de l\'erreur:', error.message);
      }
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const path = window.location.pathname.split('/').pop();
      document.querySelectorAll('.mobile-tabbar a').forEach(link => {
        if (link.getAttribute('href') === path) {
          link.classList.add('active');
        }
      });
    });
  </script>
  <script>
    // Active link dans le menu burger
    document.addEventListener('DOMContentLoaded', function () {
      const path = window.location.pathname.split('/').pop();
      document.querySelectorAll('.burger-menu a').forEach(link => {
        if (link.getAttribute('href') === path) {
          link.classList.add('active');
        }
      });
    });
  </script>
</body>

</html>