<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>Dialect ‚Äì Accueil</title>
  <link rel="stylesheet" href="styles/style.css" />
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="icon" type="image/png" href="images/logo.png" />
  <style>
    .dialect-dropdown {
      margin: 2.5em auto 1.5em auto;
      max-width: 350px;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 2px 12px #0001;
      padding: 2em 1.5em 1.5em 1.5em;
      text-align: center;
    }
    .dialect-dropdown label {
      font-size: 1.1rem;
      color: var(--text-light);
      margin-bottom: 0.7em;
      display: block;
    }
    .dialect-list {
      list-style: none;
      padding: 0;
      margin: 0.5em 0 0 0;
    }
    .dialect-list li {
      font-size: 1.15rem;
      font-weight: 600;
      padding: 0.7em 0.5em;
      border-radius: 10px;
      margin-bottom: 0.3em;
      transition: background 0.18s, color 0.18s, filter 0.18s;
      cursor: pointer;
      background: #f5f3e7;
      color: #7B61FF;
      box-shadow: 0 1px 4px #7B61FF11;
    }
    .dialect-list li:not(.active) {
      filter: blur(2.2px) grayscale(0.7) brightness(1.1);
      color: #bdbdbd;
      cursor: not-allowed;
      background: #f5f3e7;
      position: relative;
    }
    .dialect-list li:not(.active)::after {
      content: 'Bient√¥t';
      position: absolute;
      right: 1.2em;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.95em;
      color: #bfa100;
      opacity: 0.7;
    }
    .dialect-list li.active {
      background: linear-gradient(90deg, #b7c7a3 0%, #e6ebdf 100%);
      color: #2d3a1f;
      filter: none;
      cursor: pointer;
      box-shadow: 0 2px 8px #9EB79633;
      border: 2px solid #7B61FF22;
    }
    .dialect-list li.active:hover {
      background: #e6ebdf;
      color: #7B61FF;
      border-color: #7B61FF;
    }
  </style>
</head>
<body>
  <button class="mobile-menu-btn">Menu</button>
  <div class="mobile-menu-bg"></div>
  <nav class="mobile-menu">
    <a href="index.html">üè† Accueil</a>
    <a href="quiz.html">‚ùì Quiz</a>
    <a href="review.html">üîÅ R√©viser</a>
    <a href="progres.html">üìà Progr√®s</a>
    <a href="login.html">üîê Connexion</a>
  </nav>
  <nav>
    <div class="logo"><img src="images/logo.png" alt="Dialect logo" style="height:48px;vertical-align:middle;" onerror="this.style.display='none';this.parentNode.textContent='Dialect.';"></div>
    <div class="nav-links">
      <a href="index.html" class="active">Accueil</a>
    </div>
    <div class="nav-actions">
      <a href="login.html" class="btn btn-purple">Se connecter</a>
      <a href="signup.html" class="btn btn-yellow">S'inscrire</a>
    </div>
  </nav>

  <main>
    <section class="main-card" style="max-width:700px;">
      <h1>Reconnecte-toi √† ta culture avec <span style="color:#7B61FF;">Dialect.</span></h1>
      <p class="subtitle" style="font-size:1.25rem; margin-bottom:1.5em;">D√©couvre, apprends et partage les richesses de ta langue d'origine.</p>
      <p style="color:var(--text-light); font-size:1.13rem; margin-bottom:2.2em;">
        <b>Dialect</b> est une application qui te permet de te reconnecter √† ta culture √† travers l'apprentissage de ton dialecte. <br>
        
        Notre mission&nbsp;: rendre chaque langue accessible, vivante et fi√®rement partag√©e.
      </p>
      <div class="dialect-dropdown">
        <label for="dialect-select">Choisis ton dialecte&nbsp;:</label>
        <ul class="dialect-list">
          <li class="active" onclick="window.location.href='kabyle.html'">Kabyle</li>
          <li>Peul</li>
          <li>Wolof</li>
          <li>Darija</li>
          <li>Chaoui</li>
          <li>Tamazight</li>
          <li>Tachelhit</li>
          <li>Chleuh</li>
        </ul>
      </div>
      <p style="color:#bfa100; font-size:1.05rem; margin-top:1.5em;">D'autres dialectes arrivent tr√®s bient√¥t&nbsp;!</p>
    </section>
  </main>

  <footer>
    ¬© 2025 Dialect
  </footer>

  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="ui.js" type="module"></script>
  
  <!-- Script pour le menu mobile -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      console.log('=== D√âBOGAGE MENU MOBILE ===');
      
      const menuBtn = document.querySelector('.mobile-menu-btn');
      const mobileMenu = document.querySelector('.mobile-menu');
      const mobileMenuBg = document.querySelector('.mobile-menu-bg');
      
      console.log('√âl√©ments trouv√©s:', {
        menuBtn: menuBtn,
        mobileMenu: mobileMenu,
        mobileMenuBg: mobileMenuBg
      });
      
      if (!menuBtn) {
        console.error('‚ùå Bouton menu non trouv√© !');
        return;
      }
      if (!mobileMenu) {
        console.error('‚ùå Menu mobile non trouv√© !');
        return;
      }
      if (!mobileMenuBg) {
        console.error('‚ùå Fond menu non trouv√© !');
        return;
      }
      
      console.log('‚úÖ Tous les √©l√©ments trouv√©s');
      
      // Ouvrir le menu
      menuBtn.addEventListener('click', function(e) {
        console.log('üñ±Ô∏è Clic sur bouton menu d√©tect√©');
        e.preventDefault();
        e.stopPropagation();
        
        console.log('üìã Classes avant:', {
          menu: mobileMenu.className,
          bg: mobileMenuBg.className
        });
        
        mobileMenu.classList.add('open');
        mobileMenuBg.classList.add('open');
        
        console.log('üìã Classes apr√®s:', {
          menu: mobileMenu.className,
          bg: mobileMenuBg.className
        });
        
        console.log('‚úÖ Menu ouvert');
      });
      
      // Fermer le menu en cliquant sur le fond
      mobileMenuBg.addEventListener('click', function() {
        console.log('üñ±Ô∏è Clic sur fond d√©tect√©');
        mobileMenu.classList.remove('open');
        mobileMenuBg.classList.remove('open');
        console.log('‚úÖ Menu ferm√©');
      });
      
      // Fermer le menu en cliquant sur un lien
      const menuLinks = mobileMenu.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', function() {
          console.log('üñ±Ô∏è Clic sur lien menu d√©tect√©');
          mobileMenu.classList.remove('open');
          mobileMenuBg.classList.remove('open');
        });
      });
      
      console.log('‚úÖ Script menu mobile initialis√©');
    });
  </script>
  
  <script type="module">
    console.log('üöÄ Script principal charg√© !');
    import { auth, logout, initAuthListener } from "./firebase.js";
    import { renderNavAuthButtons } from "./ui.js";

    initAuthListener(user => {
      renderNavAuthButtons(user);
    });

    // Initialiser le gestionnaire de cartes et mettre √† jour le compteur (optionnel)
    async function updateDueCount() {
      try {
        await cardManager.loadCards();
        const stats = cardManager.getStats();
        const dueCountElement = document.getElementById('due-count');
        if (dueCountElement) {
          dueCountElement.textContent = stats.due;
        }
      } catch (error) {
        console.log('‚ÑπÔ∏è Compteur de cartes non disponible sur cette page');
      }
    }

    // Mettre √† jour le compteur au chargement (si possible)
    updateDueCount();

    console.log('üìö Script vocabulaire charg√© !');
    // G√©n√©ration dynamique du lexique √† partir de data3.csv (348 mots)
    function detectTheme(fr) {
      const frLower = fr.toLowerCase();
      
      // D√©tection automatique des th√®mes bas√©e sur le contenu
      if (frLower.includes('√™tre') || frLower.includes('avoir') || frLower.includes('faire') || 
          frLower.includes('aller') || frLower.includes('venir') || frLower.includes('voir') ||
          frLower.includes('dire') || frLower.includes('manger') || frLower.includes('boire') ||
          frLower.includes('dormir') || frLower.includes('travailler') || frLower.includes('apprendre')) {
        return 'Verbes';
      }
      if (frLower.includes('homme') || frLower.includes('femme') || frLower.includes('enfant') ||
          frLower.includes('p√®re') || frLower.includes('m√®re') || frLower.includes('fr√®re') ||
          frLower.includes('soeur') || frLower.includes('famille')) {
        return 'Personnes & Famille';
      }
      if (frLower.includes('eau') || frLower.includes('feu') || frLower.includes('terre') ||
          frLower.includes('ciel') || frLower.includes('soleil') || frLower.includes('lune') ||
          frLower.includes('montagne') || frLower.includes('mer') || frLower.includes('arbre')) {
        return 'Nature';
      }
      if (frLower.includes('pain') || frLower.includes('lait') || frLower.includes('viande') ||
          frLower.includes('fruit') || frLower.includes('fromage') || frLower.includes('miel')) {
        return 'Nourriture';
      }
      if (frLower.includes('maison') || frLower.includes('porte') || frLower.includes('fen√™tre') ||
          frLower.includes('chambre') || frLower.includes('cuisine') || frLower.includes('table')) {
        return 'Habitat';
      }
      if (frLower.includes('chat') || frLower.includes('chien') || frLower.includes('cheval') ||
          frLower.includes('vache') || frLower.includes('mouton') || frLower.includes('oiseau')) {
        return 'Animaux';
      }
      if (frLower.includes('main') || frLower.includes('t√™te') || frLower.includes('≈ìil') ||
          frLower.includes('nez') || frLower.includes('bouche') || frLower.includes('jambe')) {
        return 'Corps humain';
      }
      if (frLower.includes('blanc') || frLower.includes('noir') || frLower.includes('rouge') ||
          frLower.includes('vert') || frLower.includes('bleu') || frLower.includes('jaune')) {
        return 'Couleurs';
      }
      if (frLower.includes('un') || frLower.includes('deux') || frLower.includes('trois') ||
          frLower.includes('quatre') || frLower.includes('cinq') || frLower.includes('dix')) {
        return 'Nombres';
      }
      if (frLower.includes('bonjour') || frLower.includes('merci') || frLower.includes('au revoir') ||
          frLower.includes('oui') || frLower.includes('non') || frLower.includes('bonne')) {
        return 'Salutations & Communication';
      }
      if (frLower.includes('bon') || frLower.includes('mauvais') || frLower.includes('grand') ||
          frLower.includes('petit') || frLower.includes('beau') || frLower.includes('chaud')) {
        return 'Qualit√©s & Adjectifs';
      }
      if (frLower.includes('ici') || frLower.includes('l√†') || frLower.includes('dedans') ||
          frLower.includes('dehors') || frLower.includes('devant') || frLower.includes('derri√®re')) {
        return 'Lieux & Positions';
      }
      if (frLower.includes('maintenant') || frLower.includes('aujourd') || frLower.includes('demain') ||
          frLower.includes('hier') || frLower.includes('jour') || frLower.includes('nuit')) {
        return 'Temps';
      }
      
      return 'Autres';
    }
    function renderLexique(data) {
      console.log('üéØ renderLexique appel√©e avec:', data);
      const themes = {};
      data.forEach((row, index) => {
        const fr = row['mot francais']?.trim();
        const kab = row['traduction kabyle']?.trim();
        console.log(`üìù Ligne ${index}: fr="${fr}", kab="${kab}"`);
        if (!fr || !kab) {
          console.log(`‚ö†Ô∏è Ligne ${index} ignor√©e: fr ou kab manquant`);
          return;
        }
        const theme = detectTheme(fr);
        console.log(`üè∑Ô∏è Th√®me d√©tect√© pour "${fr}": ${theme}`);
        if (!themes[theme]) themes[theme] = [];
        // S√©parer les traductions multiples
        const traductions = kab.split('/').map(t => t.trim()).filter(t => t);
        themes[theme].push({ fr, kab });
      });
      console.log('üé® Th√®mes cr√©√©s:', themes);
      // Remplir dynamiquement le menu d√©roulant avec les th√®mes d√©tect√©s
      const themeSelect = document.getElementById('theme-select');
      themeSelect.innerHTML = '<option value="all">Tous les th√®mes</option>';
      Object.keys(themes).forEach(theme => {
        const option = document.createElement('option');
        option.value = theme;
        option.textContent = theme;
        themeSelect.appendChild(option);
      });
      // Affichage filtr√©
      function displayLexique(selectedTheme = 'all') {
        let html = '';
        Object.keys(themes).forEach(theme => {
          if (selectedTheme === 'all' || theme === selectedTheme) {
            html += `<div class='lexique-theme'><h3>${theme}</h3><ul class='lexique-list'>`;
            themes[theme].forEach(({fr, kab}) => {
              html += `<li><span class='fr'>${fr}</span> <span class='kab'>${kab}</span></li>`;
            });
            html += '</ul></div>';
          }
        });
        document.getElementById('lexique-content').innerHTML = html;
      }
      displayLexique();
      themeSelect.addEventListener('change', (e) => {
        displayLexique(e.target.value);
      });
    }
    Papa.parse('/data/320_mots_a_la_main.csv', {
      download: true,
      header: true,
      skipEmptyLines: true,
      delimiter: ';',
      complete: ({ data }) => {
        console.log('üìä Donn√©es CSV charg√©es:', data);
        console.log('üìä Nombre de lignes:', data.length);
        console.log('üìä Premi√®re ligne:', data[0]);
        renderLexique(data);
      },
      error: (error) => {
        console.error('‚ùå Erreur de chargement CSV:', error);
      }
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const path = window.location.pathname.split('/').pop();
      document.querySelectorAll('.mobile-tabbar a').forEach(link => {
        if (link.getAttribute('href') === path) {
          link.classList.add('active');
        }
      });
    });
  </script>
  <script>
    // Active link dans le menu burger
    document.addEventListener('DOMContentLoaded', function() {
      const path = window.location.pathname.split('/').pop();
      document.querySelectorAll('.burger-menu a').forEach(link => {
        if (link.getAttribute('href') === path) {
          link.classList.add('active');
        }
      });
    });
  </script>
</body>
</html>